/*! databinder v 0.8.0 - 2015-04-21
    MIT License - Â© 2015 syllab.fr */
!function(a){function b(a){return"function"==typeof a}function c(a){return"object"==typeof a}function d(a){switch(typeof a){case"string":return new String(a);case"number":return new Number(a);case"boolean":return new Boolean(a);default:return a}}function e(a){this.name="DatabinderError",this.message="[Databinder] "+a}function f(a,b,c){if(p)a.classList[c?"add":"remove"](b);else{var d=a.className.split(" "),e=d.indexOf(b);c&&-1===e?d.push(b):!c&&e>=0&&d.splice(e,1),a.className=d.join(" ").trim()}}function g(a){this.bindings={},this.eventListeners={},this.originalInnerHTML=a.innerHTML,this.element=a,a.databinding=this}function h(a,b,c){return a instanceof h?a:(this.databinding=c,this.observers={},this.data=this.makeObservable(d(a||{})),void(this.parent=b))}function i(c,d,e){var f=q.bindings[d]||("on"+d in a?q.bindings.on:q.defaultBinding);for(var g in f)f.hasOwnProperty(g)&&(this[g]=f[g]);this.element=c,this.attribute=d,this.declaration="{"===e[0]?this.getBindingSet(e):e,b(this.init)&&this.init(c.databinding)}var j,k="data-bind",l="databind",m=/(?:^|,)\s*(?:(\w+):)?\s*([\w\.\/\|\'\"\s-]+|{.+})+/g,n=["pop","push","reverse","shift","sort","splice","unshift"],o={SET:"SET",SPLICE:"SPLICE"};e.prototype=new Error,e.prototype.constructor=e;var p="classList"in document.createElement("p");g.prototype={set:function(a){return this.scope=new h(a,null,this),this.innerScope=this.scope,this.data=this.scope.data,this.bindings=this.getBindings(),this.reset()},reset:function(){return void 0!==this.originalInnerHTML&&(this.element.innerHTML=this.originalInnerHTML),this.applyBindings(),this},get:function(){if((this.element instanceof HTMLInputElement||this.element instanceof HTMLTextAreaElement)&&"value"in this.bindings&&(this.scope.lookup(this.bindings.value).data[this.bindings.value]=this.element.value),this.element.children)for(var a=0,b=this.element.children.length;b>a;a++){var c=this.element.children[a];c.databinding instanceof g&&c.databinding.get()}return this},getBindings:function(){var a,b,c,d={};if(this.element.hasAttribute(k))if(c=this.element.getAttribute(k)){var f=m.exec(c);if(null===f)throw new e("Invalid argument for data-binding: "+c);for(;null!==f;)a=f[2],b=f[1]||this.guessAttribute(a),d[b]=new i(this.element,b,a),f=m.exec(c)}else a=this.guessValue(),b=this.guessAttribute(a),b in q.bindings&&(d[b]=new i(this.element,b,a));return d},applyBindings:function(){for(var a in this.bindings)if(this.bindings.hasOwnProperty(a)&&(j=this.bindings[a],j.apply(j.declaration,this.scope)===!1))return;j=null,null!==this.innerScope&&this.parseChildren(this.innerScope)},bindTemplate:function(a){var b=document.getElementById(a);if(null===b)throw new e("Template not found: "+a);this.element.innerHTML=b.innerHTML},parseChildren:function(a){var b,c;if(a instanceof h&&this.element.children){for(c=[],b=0;b<this.element.children.length;b++)c.push(this.element.children[b]);for(b=0;b<c.length;b++)c[b]instanceof Element&&q(c[b]).set(a)}},guessValue:function(){var a,b,c=[];for(c=c.concat(this.element.id||[]).concat(this.element.getAttribute("name")||[]).concat(this.element.className.match(/[^ ]+/g)||[]),a=0;a<c.length;a++)if(c[a]&&null!==(b=this.scope.resolve(c[a],this.element)))return c[a];throw new e("No binding value suitable for element "+this.element.outerHTML)},guessAttribute:function(a){var b=this.scope.resolve(a,this.element),c=b?b.constructor:null;switch(!0){case c===Object:return"with";case c===Array:return"loop";case b instanceof Element:return"html";case c===Boolean:return this.element.constructor===HTMLInputElement&&"checked"in this.element?"checked":this.element.constructor===HTMLOptionElement?"selected":"if";case c===String:case c===Number:return this.element.constructor===HTMLInputElement?"value":"src"in this.element?"src":"text";default:return"text"}}},h.prototype={lookup:function(a,b){var d,e,f,g,i=this,j=this.data;if("."===a)return i;if("/"===a[0]){for(;i.parent;)i=i.parent;a=a.slice(1)}else if("."===a[0]){for(f=0;"."===a[++f]&&i.parent;)i=i.parent,j=i.data;j=i.data,a=a.slice(f)}else for(d=a.split(".")[0];i.parent&&(j=i.data,!c(j)||!j.hasOwnProperty(d));)i=i.parent;for(e=a.split("."),f=0,g=e.length-1,b===!0&&g++;void 0!==j&&g>f;)j=this.evalFunction(j[e[f++]]),i=new h(j,i,this.databinding);return i},evalFunction:function(a){var c;if(b(a)){for(c=this;c&&c.parent;)c=c.parent;a=a.call(this.data,c.data,this.databinding.element)}return a},resolve:function(a,c){var d,f,g,h,i,j,k,l,m=a.split("|"),n=this.resolveParam(m.shift().trim());if(c||(n=this.evalFunction(n)),m.length>0)for(d=0,f=m.length;f>d;d++){if(i=m[d].trim().split(/\s+/),l=i.shift(),k=q.extensions[l],void 0===k||!b(k))throw new e("Unknown extension: "+l);for(j=[],g=0,h=i.length;h>g;g++)j.push(this.resolveParam(i[g]));n=k.apply(n,j)}return n},resolveParam:function(a){var b,c;return isNaN(a)?'"'===a[0]||"'"===a[0]?a.slice(1,-1):(c=this.lookup(a,!1),"."===a?c.data:(b=a.match(/([^\/\.\s]+)\s*$/)[1],c.data[b])):+a},makeObservable:function(a,c){var d,e=this,f=Array.isArray(a);if(a instanceof Object==!1)return a;if(d=f?a.slice():b(a)?function(){return a.apply(this,arguments)}:Object.create(Object.getPrototypeOf(a),{}),f){var g=c||".";n.forEach(function(b){Object.defineProperty(d,b,{configurable:!0,value:function(){var d,f,h,i;switch(b){case"pop":d=a.length-1,h=1,f=0;break;case"push":d=a.length,h=0,f=arguments.length;break;case"reverse":case"sort":d=0,h=a.length,f=a.length;break;case"shift":d=0,h=1,f=0;break;case"unshift":d=0,h=0,f=arguments.length;break;case"splice":d=arguments[0],h=arguments[1],f=arguments.length-2}return i=a[b].apply(a,arguments),e.makeObservable(a,c),e.callObservers(o.SPLICE,g,d,h,f),i}})})}return Object.getOwnPropertyNames(a).forEach(function(b){var f=c?c+"."+b:b,g=Object.getOwnPropertyDescriptor(a,b);g&&g.configurable&&(g.get=function(){return f in e.observers||(e.observers[f]=[]),j&&-1===e.observers[f].indexOf(j)&&e.observers[f].push(j),a[b]instanceof Object?e.makeObservable(a[b],f):a[b]},g.set=function(c){a[b]=c,e.callObservers(o.SET,f,c),f in e.observers&&e.observers[f].forEach(function(a){a.react(o.SET,f,c)})},delete g.value,delete g.writable,Object.defineProperty(d,b,g))}),d},callObservers:function(a,b){if(b in this.observers){var c,d,e=this.observers[b];for(c=0,d=e.length;d>c;c++)e[c].react.apply(e[c],arguments)}}},i.prototype={getBindingSet:function(a){for(var b={},c=a.slice(1,-1).split(","),d=0,f=c.length;f>d;d++){var g=c[d].match(/(\w+):\s*([\w\.\/\|\s]+)/);if(null===g||g.length<3)throw new e("Invalid argument for binding set: "+c[d]);b[g[1].trim()]=g[2].trim()}return b},apply:function(a,b){this.set(b.resolve(a))},react:function(){this.apply(this.declaration,this.element.databinding.scope)}};var q=function(a,b){var c=a instanceof Element?a:document.querySelector(a);if(null===c)throw new e("No element matched for selector "+a);var d=c.databinding||new g(c);return void 0!==b&&d.set(b),d};return q.defaultBinding={set:function(a){null===a?this.element.removeAttribute(this.attribute):a===!0||a===!1?this.element[this.attribute]=a:void 0!==a&&this.element.setAttribute(this.attribute,a)}},q.bindings={text:{init:function(a){a.innerScope=null},get:function(){return this.element.textContent},set:function(a){void 0!==a&&(this.element.textContent=a)}},html:{init:function(a){a.innerScope=null},set:function(a){a instanceof Element?(this.element.innerHTML="",this.element.appendChild(a)):void 0!==a&&(this.element.innerHTML=a)}},style:{apply:function(a,b){var c,d;if(a instanceof Object)for(c in a)a.hasOwnProperty(c)&&(d=b.resolve(a[c]),void 0!==d&&(this.element.style[c]=d));else if(d=b.resolve(a),d instanceof Object)for(c in d)d.hasOwnProperty(c)&&void 0!==d[c]&&(this.element.style[c]=d[c]);else this.element.setAttribute("style",d)}},"class":{apply:function(a,b){var c;if(a instanceof Object)for(c in a)a.hasOwnProperty(c)&&f(this.element,c,b.resolve(a[c]));else if(a=b.resolve(a,this.element),Array.isArray(a))this.element.className=a.join(" ");else if(a instanceof Object)for(c in a)a.hasOwnProperty(c)&&f(this.element,c,a[c]);else this.element.className=a}},"if":{set:function(a,b){return Boolean(a)===Boolean(b)?(this.element.parentNode.removeChild(this.element),!1):void 0}},ifnot:{set:function(a){return q.bindings.if.set.call(this,a,!0)}},visible:{set:function(a,b){var c=Boolean(a)!==Boolean(b);this.element.hidden=!c,this.element.style.display=c?"":"none"}},hidden:{set:function(a){return q.bindings.visible.set.call(this,a,!0)}},loop:{init:function(a){a.innerScope=null},apply:function(a,b){if(c(a)||(a={"in":a}),void 0===a["in"])throw new e("No list specified for loop declaration: "+a);this.list=a["in"],this.index=a.at||"loopIndex",this.item=a.as||"loopValue",this.childNodes=[],this.innerScope=b.lookup(this.list,!1);for(var d=0,f=this.element.childNodes.length;f>d;d++)this.childNodes.push(this.element.childNodes[d].cloneNode(!0));this.element.innerHTML="",this.parseChildren()},parseChildren:function(){var a,c,d,e;if(this.iterations=[],this.innerScope instanceof h){if(e=this.innerScope.resolve(this.list,!0),Array.isArray(e))for(a=0,c=e.length;c>a;a++)this.iterations.push({key:a,value:e[a]});else if(b(e))for(a=0;null!==(d=this.innerScope.evalFunction(e));a++)this.iterations.push({key:a,value:d});else if(e instanceof Object)for(a in e)e.hasOwnProperty(a)&&this.iterations.push({key:a,value:e[a]});for(a=0;a<this.iterations.length;a++)this.iterate(a)}},iterate:function(a){var b,c,d,e=this.iterations[a],f=new h(e.value,this.innerScope,this);for(f.data[this.index]=e.key,f.data[this.item]=e.value,e.nodes=[],b=0,c=this.childNodes.length;c>b;b++)d=this.childNodes[b].cloneNode(!0),e.nodes.push(d),this.iterations[a+1]&&this.iterations[a+1].nodes?this.element.insertBefore(d,this.iterations[a+1].nodes[0]):this.element.appendChild(d),d instanceof Element&&q(d).set(f)},react:function(a,b){if(a===o.SPLICE)this.splice.apply(this,[].slice.call(arguments,2));else if(a===o.SET){var c,d,e,f=b.split(".");if(f.length>1){for(e=f[1],c=0,d=this.iterations.length;d>c;c++)if(e==this.iterations[c].key){this.splice(c,1,1);break}}else this.parseChildren()}},splice:function(a,b,c){var d,e,f,g;for(d=a;a+b>d&&d in this.iterations;d++)for(e=0,f=this.iterations[d].nodes.length;f>e;e++)this.element.removeChild(this.iterations[d].nodes[e]);for(g=this.innerScope.resolve(this.list,!0),d=a;a+c>d;d++)this.iterations[d]={key:d,value:g[d]},this.iterate(d)}},"with":{set:function(a){this.element.databinding.innerScope=new h(a,this.element.databinding.scope,this.element.databinding)}},on:{apply:function(a,d){function f(a){return function(b){a.call(i.scope.data,b,j.data,i.element)}}var g,h,i,j,k;if(!c(a)){if("string"!=typeof a)throw new e('"on" binding expects a binding set, instead got '+a);k={},k[this.attribute]=a,a=k}for(i=this.element.databinding,j=i.scope;j&&j.parent;)j=j.parent;for(g in a)if(a.hasOwnProperty(g)&&(h=d.resolve(a[g],i.element,!0),b(h))){var l=f(h);g in i.eventListeners&&this.element.removeEventListener(g,i.eventListeners[g]),i.eventListeners[g]=l,this.element.addEventListener(g,l)}}}},q.extensions={},a[l]=q,q}(this),function(a,b){a&&(a.fn.databind=function(a){return this.each(function(){var c=b(this);a in c&&c[a].apply(c,[].slice.call(arguments,1))})})}(jQuery,databind);